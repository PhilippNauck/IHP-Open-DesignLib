#==========================================================================
# Copyright 2024 IHP PDK Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#    https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# SPDX-License-Identifier: Apache-2.0
#==========================================================================

name: DRC

on: push

jobs:
    drc:
        runs-on: ubuntu-latest
        steps:
            -   name: Installing Klayout
                run: |
                    sudo apt update -qq -y
                    wget https://www.klayout.org/downloads/Ubuntu-22/klayout_0.29.0-1_amd64.deb
                    # The dpkg command will fail complaining about missing dependencies.
                    sudo dpkg -i ./klayout_0.29.0-1_amd64.deb || true
                    # The apt install command should install the missing dependencies
                    # needed by KLayout above and finish the install.
                    sudo apt install -f -y
                    # Check that KLayout was successfully installed!
                    klayout -v
            -   name: Install IHP_Open_PDK
                uses: actions/checkout@master
                with:
                    repository: IHP-GmbH/IHP-Open-PDK
                    ref: dev
            -   name: Install IHP_Open_DesignLib
                uses: actions/checkout@master
            -   name: drc
                run: |
                    export KLAYOUT_HOME=/ihp-sg13g2/libs.tech/klayout/tech klayout
                    ls
                    echo "change"
                    cd ..
                    ls
                    echo "change"
                    cd ..
                    ls
                # klayout -b -r ./ihp-sg13g2/libs.tech/klayout/tech/drc/sg13g2_minimal.lydrc -rd "in_gds"="AnalogLDO_exampleDesign/design_data/klayout/gds/LDO.gds"
                #AnalogLDO_exampleDesign/design_data/klayout/gds/LDO.gds
                # -> IHP-Open-DesignLib
